<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.market.root.mybatis.product.ProductMapper">
<resultMap type="com.market.root.product.dto.ProductDTO" id="product">
	<result property="mbrId" column="mbr_id"/>
	<result property="prodId" column="prod_id"/>
	<result property="prodTitle" column="prod_title"/>
	<result property="price" column="price"/>
	<result property="hit" column="hit"/>
	<result property="trdLocation" column="trd_location"/>
	<result property="prodContent" column="prod_content"/>
	<result property="prodDate" column="prod_date"/>
	<result property="prodStat" column="prod_stat"/>
	<result property="cateCode" column="cate_code"/>
</resultMap>

<!-- 게시글 개수 불러오기 -->
<select id="psAllView" resultMap="product">
	select B.* from(select rownum rn, A.* from
	(select * from prod_info order by prod_id desc)A)B 
	where rn between #{s} and #{e}
</select>

<!-- 게시글 모든 행 불러오기 -->
<select id="selectBoardCount" resultType="Integer">
	select count(*) from prod_info
</select>

<!-- 상품 검색항목 모두 불러오기 -->
<select id="search" resultMap="product">
	select * from prod_info where prod_title = #{keyword}
</select>

<!-- 물품 등록 -->
<insert id="prodRegister">
	insert all into prod_info (mbr_id, prod_id, prod_title, price,trd_location,prod_content)
	values(#{mbrId}, prod_id_seq.nextval,#{prodTitle},#{price},#{trdLocation},#{prodContent}) 
	into image (prod_id, tum_img, org_img) values(prod_id_seq.currval,#{tumImg},#{orgImg}) select * from dual
</insert>

</mapper>